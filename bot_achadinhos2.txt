from telegram.ext import Application, MessageHandler, filters
from telegram import Update
from telegram.ext import ContextTypes

# Token do seu bot
TOKEN = '7651883636:AAE5sCD0J5JmaYqmTzPKs3MC5sqtzl1HArM'

# FunÃ§Ã£o para criar o texto do anÃºncio
async def criar_anuncio(update: Update, context: ContextTypes.DEFAULT_TYPE):
    mensagem = update.message.text

    if all(campo in mensagem.lower() for campo in ["nome:", "descricao:", "preco:", "link:"]):
        linhas = mensagem.split('\n')
        dados = {}
        for linha in linhas:
            if ':' in linha:
                chave, valor = linha.split(':', 1)
                dados[chave.strip().lower()] = valor.strip()

        nome = dados.get("nome", "Produto incrÃ­vel")
        descricao = dados.get("descricao", "DescriÃ§Ã£o nÃ£o informada.")
        preco = dados.get("preco", "PreÃ§o nÃ£o disponÃ­vel")
        link = dados.get("link", "Link nÃ£o disponÃ­vel")

        anuncio = f"""ğŸ“¸ [Imagem do produto]
@achhadinhos_mil

ğŸ˜² PreÃ§o de cair o queixo! Corre que vai acabar!

ğŸ”¥ {nome} â€“ {descricao}

ğŸ’° Por apenas R$ {preco} ğŸ˜±

ğŸ›’ Compre agora ğŸ‘‰ {link}

âš ï¸ PromoÃ§Ã£o sujeita Ã  alteraÃ§Ã£o de preÃ§o e estoque do site"""
        await update.message.reply_text(anuncio)
    else:
        await update.message.reply_text(
            "Por favor, envie a mensagem no seguinte formato:\n\n"
            "nome: Nome do produto\n"
            "descricao: Breve descriÃ§Ã£o\n"
            "preco: 29.90\n"
            "link: https://exemplo.com/produto"
        )

# FunÃ§Ã£o principal
def main():
    application = Application.builder().token(TOKEN).build()
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, criar_anuncio))
    application.run_polling()

if __name__ == '__main__':
    main()
